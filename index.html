<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <title>Astro Kviz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
body {
  background: linear-gradient(to right, #1e1e2f, #2c2c3e);
  color: #f0f0f5;
  font-family: 'Segoe UI', sans-serif;
  text-align: center;
  padding: 40px;
  margin: 0;
}

h2 {
  font-size: 2em;
  color: #ffd700;
  margin-bottom: 20px;
  text-shadow: 1px 1px 5px #000;
}

#quiz {
  max-width: 60vw; /* or try 100% */
  margin: 0 auto;
  padding: 10px;
  background-color: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
box-shadow: 0 0 20px rgba(255, 255, 255, 0.1), 0 4px 12px rgba(0, 0, 0, 0.2);
}

#themeTitle {
  font-size: 1.3em;
  color: #87cefa;
  margin-bottom: 15px;
  text-transform: uppercase;
  letter-spacing: 1px;
}
#progressBox {
  margin: 20px auto;
  padding: 15px 20px;
  max-width: 600px;
  font-size: 1.1em;
  color: #f0f0f5;
  background-color: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.1), 0 4px 12px rgba(0, 0, 0, 0.2);
  text-align: center;
}

#question {
  font-size: 1.4em;
  margin-bottom: 20px;
  color: #f0f0f5;
}

#answers button {
  display: block;
  width: 100%;
  margin: 12px 0;
  padding: 14px 24px;
  font-size: 1.2em;
  border-radius: 8px;
  border: none;
  background-color: #ffd700;
  color: #1e1e2f;
  cursor: pointer;
  transition: background-color 0.3s ease;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
}

#answers button:hover {
  background-color: #ffcc00;
}

#result {
  font-size: 1.5em;
  color: #ffd700;
  margin-top: 30px;
  padding: 20px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 12px;
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
}

#restartBtn,
#partnerBtn {
  margin-top: 20px;
  padding: 12px 24px;
  font-size: 1.1em;
  border-radius: 8px;
  border: none;
  background-color: #ffd700;
  color: #1e1e2f;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

#restartBtn:hover,
#partnerBtn:hover {
  background-color: #ffcc00;
}


/* üéØ WhatsApp button style */
#extraActions #whatsappShareBtn {
  background-color: #25D366 !important;
  color: #fff;
  font-size: 1.0em;
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  margin-top: 10px;
  transition: background-color 0.3s ease;
}

#extraActions #whatsappShareBtn:hover {
  background-color: #1ebe5d !important;
}

#extraActions button {
  background-color: #f5f5f5;
  color: #1e1e2f;
  font-weight: normal; /* removed bold */
  font-size: 1.0em;
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  margin: 10px 0;
  transition: background-color 0.3s ease;
}

#extraActions button:hover {
  background-color: #ffe680; /* soft warm yellow */
}




/* üéØ WhatsApp button style */
#whatsappShareBtn {
  background-color: #25D366; /* WhatsApp green */
  color: #fff;
  font-size: 1.1em;
  padding: 12px 20px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  margin-top: 10px;
  transition: background-color 0.3s ease;
}

#whatsappShareBtn:hover {
  background-color: #1ebe5d; /* darker green on hover */
}


.button-row {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.action-btn {
  display: inline-block;
  padding: 12px 24px;
  font-size: 1.1em;
  border-radius: 8px;
  background-color: #ffd700;
  color: #1e1e2f;
  text-decoration: none;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.action-btn:hover {
  background-color: #ffcc00;
}

/* üì± Mobile adjustments */
@media (max-width: 768px) {
  body {
    padding: 20px;
  }

  h2 {
    font-size: 1.6em;
  }
  
  #quiz {
    max-width: 100vw;
    padding: 15px;
  }
  
  #question {
    font-size: 1.2em;
  }

  #answers button {
    font-size: 1.1em;
    padding: 12px 20px;
  }

  #result {
    font-size: 1.3em;
    padding: 15px;
  }

  #restartBtn,
  #partnerBtn,
  #extraActions button {
    width: 100%;
    font-size: 1em;
  }
}
</style>

</head>
<body>

<div id="quiz">
  <h2 style="text-align:center;">Va≈° Idealan Partner</h2>

  <!-- üü® Ad: Top of quiz -->
  <div class="ezoic-ad" id="ezoic-pub-ad-1"></div>

  <!-- üß≠ Quiz content -->
  <div id="themeTitle"></div>
  <div id="progressBox"></div>
  <div id="question"></div>
  <div id="answers"></div>

  <!-- üü® Ad: Between questions and result -->
  <div class="ezoic-ad" id="ezoic-pub-ad-2"></div>
<div id="loading" style="display:none;">üîÑ Uƒçitavanje rezultata...</div>

  <!-- üéØ Result -->
  <div id="result" style="display:none;"></div>

  <!-- üîÅ Result actions -->
  <div class="button-row" style="display:none;" id="resultActions">
    <button id="restartBtn">üîÑ Ponovno rije≈°i kviz</button>
    <a href="https://www.lfbuyer.com/hr/listing/postati-uspje%C5%A1an-influencer-na-dru%C5%A1tvenim-mre%C5%BEama/"
       target="_blank"
       id="partnerBtn"
       class="action-btn">üíò Oglasi</a>
  </div>

  <!-- üü® Ad: Before extra actions -->
  <div class="ezoic-ad" id="ezoic-pub-ad-3"></div>

  <!-- üåê Extra actions -->
  <div id="extraActions" style="margin-top: 30px;">
    <a href="https://www.lfbuyer.com/zodiac/" target="_blank">
      <button>üåê Posjeti LFbuyer.com</button>
    </a>
    <a href="https://www.facebook.com/rio.lfbuyer/" target="_blank">
      <button>üëç Lajkaj nas na Facebooku</button>
    </a>
    <button id="whatsappShareBtn" style="margin-top: 10px;">
      üì≤ Proslijedi Kviz i Rezultat Putem WhatsAppa
    </button>
  </div>

  <!-- üü® Ad: Bottom of quiz -->
  <div class="ezoic-ad" id="ezoic-pub-ad-4"></div>
</div>


<script>
// üåå Global declarations
let allQuizSets = {};
let quizData = {};
let themeKeys = [];
let totalQuestions = 0;
let currentThemeIndex = 0;
let currentQuestionIndex = 0;
let scores = {};
let results = {};
let fallbackPool = [];
const selectedSigns = [];
const selectedSetKey = "idealPartnerSet";

// üí° Motivational tips
const tips = [
  "'Ponovno rije≈°i kviz' - Jeste li znali da se kviz sastoji od pet kategorija, s po tri pitanja u svakoj? Svaki put kad ga rije≈°ite, pitanja se mijenjaju ‚Äî otkrijte nove nijanse svog astrolo≈°kog profila!",
  "Jeste li znali da na LFbuyer.com postoji interaktivna igra za zabavu ‚Äî simulacija nogometne sezone? Simuliraj tko ƒáe biti prvak u nogometu.",
  "Oglasite svoju tvrtku besplatno na LFbuyer.com ‚Äî svaki korisnik kviza mo≈æe vas otkriti klikom na 'Oglasi'.",
  "Jeste li znali da se pomoƒáu 'home staginga' kuƒáe i stanovi prodaju ƒçak 75% br≈æe i po 25% vi≈°oj cijeni? Vi≈°e o ovoj uƒçinkovitoj tehnici pripreme nekretnina za prodaju saznajte na blogu LFbuyer.com.",
  "Klikom na 'Posjeti LFbuyer.com' mo≈æete besplatno oglasiti svoje proizvode, usluge ili poslovanje ‚Äî i uƒçiniti ih vidljivima svima koji rije≈°avaju ovaj kviz.",
  "Jeste li znali da je LFbuyer skraƒáenica od 'Looking For a buyer' ‚Äì tj. tra≈æim kupca...",
  "Kliknite na 'Lajkaj nas na Facebooku', zatim 'Prati', kako biste ostali u kontaktu s nama.",
  "Jeste li znali da pomoƒáu opcije 'Proslijedi Kviz i Rezultat Putem WhatsAppa' mo≈æete poslati kviz i svoj rezultat kao poruku osobi koja vam je draga?"
];

// üîÅ Shuffle utility
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// üîÅ Get next unused fallback, reshuffle when empty
function getNextFallback() {
  if (!Array.isArray(results.fallbacks) || results.fallbacks.length === 0) {
    return "üå´ Zvijezde ≈°ute, ali ti zna≈° put.";
  }
  if (fallbackPool.length === 0) {
    fallbackPool = shuffleArray([...results.fallbacks]);
  }
  return fallbackPool.pop();
}

// üé≤ Initialize quiz
function initializeQuiz() {
  quizData = allQuizSets[selectedSetKey];
  themeKeys = shuffleArray(Object.keys(quizData));

  themeKeys.forEach(subtheme => {
    const arr = quizData[subtheme];
    if (!Array.isArray(arr)) return;
    shuffleArray(arr);
    arr.forEach(q => shuffleArray(q.answers));
  });

  totalQuestions = themeKeys.reduce(
    (sum, t) => sum + (Array.isArray(quizData[t]) ? quizData[t].length : 0),
    0
  );

  currentThemeIndex = 0;
  currentQuestionIndex = 0;
  scores = {};
  selectedSigns.length = 0;

  document.getElementById("result").style.display = "none";
  document.getElementById("resultActions").style.display = "none";
  document.getElementById("extraActions").style.display = "none";
  document.getElementById("loading").style.display = "none";
  document.getElementById("themeTitle").style.display = "block";
  document.getElementById("question").style.display = "block";
  document.getElementById("answers").style.display = "block";

  showQuestion();
}

// üñºÔ∏è Show question
function showQuestion() {
  if (currentThemeIndex >= themeKeys.length) return showResult();

  const theme = themeKeys[currentThemeIndex];
  const questions = quizData[theme];
  if (!Array.isArray(questions) || questions.length === 0) {
    currentThemeIndex++;
    currentQuestionIndex = 0;
    return showQuestion();
  }
  if (currentQuestionIndex >= questions.length) {
    currentThemeIndex++;
    currentQuestionIndex = 0;
    return showQuestion();
  }

  const qObj = questions[currentQuestionIndex];
  let currentCount = themeKeys
    .slice(0, currentThemeIndex)
    .reduce((s, t) => s + quizData[t].length, 0) + currentQuestionIndex + 1;

  const tipText =
    currentCount === totalQuestions
      ? tips[tips.length - 1]
      : tips[Math.floor(Math.random() * (tips.length - 1))];

  document.getElementById(
    "progressBox"
  ).innerText = `üî¢ ${currentCount}/${totalQuestions} ‚Äî üí° TIP: ${tipText}`;
  document.getElementById("themeTitle").innerText = `Tema: ${theme.toUpperCase()}`;
  document.getElementById("question").innerText = qObj.question;

  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";
  qObj.answers.forEach(ans => {
    const btn = document.createElement("button");
    btn.innerText = ans.text;
    btn.onclick = () => {
      selectedSigns.push(ans.sign);
      scores[ans.sign] = (scores[ans.sign] || 0) + 1;
      currentQuestionIndex++;
      showQuestion();
    };
    answersDiv.appendChild(btn);
  });
}

// üèÅ Show result
function showResult() {
  document.getElementById("themeTitle").style.display = "none";
  document.getElementById("question").style.display = "none";
  document.getElementById("answers").style.display = "none";
  document.getElementById("extraActions").style.display = "block";
  document.getElementById("loading").style.display = "block";

  fetch("https://astro-api-omega.vercel.app/api/evaluate", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "x-quiz-token": "samja-astro-2025"
    },
    body: JSON.stringify(selectedSigns)
  })
    .then(res => res.json())
    .then(data => {
  const verdict = getNextFallback(); // ignore data.verdict
  renderResult(verdict);
})

    .catch(err => {
      console.error("Gre≈°ka:", err);
      renderResult(getNextFallback());
      alert("Do≈°lo je do problema s povezivanjem zvijezda.");
    });
}
// ü™ê Store shuffled verdicts per sign
const verdictPools = {};
// ‚ú® Thematic verdict generator
function getSignBasedVerdict(sign) {
  const themed = {
    Ovan: [
      "üî• Tvoja energija pokreƒáe zvijezde.",
      "‚ö° Tvoj impuls je iskra sudbine."
    ],
    Bik: [
      "üåø Tvoja postojanost gradi svjetove.",
      "üçÉ Ljubav s tobom cvjeta u ti≈°ini."
    ],
    Blizanci: [
      "üí¨ Tvoje misli ple≈°u kao vjetar.",
      "üé≠ Svaka tvoja rijeƒç nosi ƒçaroliju."
    ],
    Rak: [
      "ü´∂ Tvoja nje≈ænost stvara svjetove.",
      "üåô Osjeƒáa≈° dublje nego ≈°to zvijezde znaju."
    ],
    Lav: [
      "ü¶Å Tvoja strast osvaja svemir.",
      "üåû Ti si sunce u tuƒëem nebu."
    ],
    Djevica: [
      "üß† Tvoja preciznost donosi mir.",
      "üìé Svemir se oslanja na tvoju jasnoƒáu."
    ],
    Vaga: [
      "‚öñÔ∏è Tvoja ravnote≈æa lijeƒçi srca.",
      "üé® Ljubav s tobom je simfonija harmonije."
    ],
    ≈†korpion: [
      "ü¶Ç Tvoja dubina mami tajne svemira.",
      "üåë Ljubav s tobom je transformacija."
    ],
    Strijelac: [
      "üèπ Tvoja iskrenost osvjetljava put.",
      "üåç Tvoja du≈°a tra≈æi istinu u zvijezdama."
    ],
    Jarac: [
      "‚õ∞Ô∏è Tvoja snaga gradi vjeƒçnost.",
      "üï∞ Ljubav s tobom traje kroz epohe."
    ],
    Vodenjak: [
      "üîÆ Tvoja vizija mijenja galaksije.",
      "üåå Misli ti lete br≈æe od svjetlosti."
    ],
    Ribe: [
      "üåä Tvoja intuicija plovi kroz dimenzije.",
      "üéê Tvoje srce pjeva jezikom snova."
    ]
  };
  // Initialize and shuffle if not yet done
  if (!verdictPools[sign]) {
    const pool = themed[sign] || results.fallbacks;
    verdictPools[sign] = shuffleArray([...pool]);
  }

  // Rotate through the pool
  if (verdictPools[sign].length === 0) {
    const pool = themed[sign] || results.fallbacks;
    verdictPools[sign] = shuffleArray([...pool]);
  }

  return verdictPools[sign].pop();
}

// üé® Render result
function renderResult(_unused) {
  document.getElementById("loading").style.display = "none";
  const topSign = Object.entries(scores).sort((a, b) => b[1] - a[1])[0][0];
  const { emoji, description, traits, connection } = signDescriptions[topSign];
  const resultDiv = document.getElementById("result");
  resultDiv.style.display = "block";

  const poeticVerdict = getSignBasedVerdict(topSign);

  resultDiv.innerText =
    `${emoji} Tvoj dominantni astrolo≈°ki znak je: ${topSign}.\n\n` +
    `Tvoj idealan partner nosi energiju znaka ${topSign} ‚Äî ${description}.\n` +
    `Privlaƒçe te osobine poput ${traits}, a tvoja ljubavna dinamika najbolje funkcionira s osobom koja te ${connection}.\n\n` +
    `üíò Otkrij tko te ƒçeka meƒëu zvijezdama!\n\n` +
    `üîÆ Poetski rezultat: ${poeticVerdict}`;
  document.getElementById("resultActions").style.display = "flex";
}


// üåå Zodiac descriptions
const signDescriptions = {
  Ovan:      { emoji:"üî•", description:"strastven, energiƒçan i pun inicijative", traits:"odva≈ænosti, direktnosti i neovisnosti", connection:"motivira te da riskira≈° i slijedi≈° srce" },
  Bik:       { emoji:"üåø", description:"stabilan, senzualan i pouzdan", traits:"nje≈ænosti, lojalnosti i osjeƒáaja za u≈æitak", connection:"smiruje tvoju du≈°u i pru≈æa sigurnost" },
  Blizanci:  { emoji:"üí¨", description:"duhovit, znati≈æeljan i komunikativan", traits:"mentalne stimulacije, spontanosti i zabave", connection:"dr≈æi tvoj um budnim i srce razigranim" },
  Rak:       { emoji:"ü´∂", description:"emotivan, bri≈æan i intuitivan", traits:"topline, nje≈ænosti i duboke povezanosti", connection:"stvara prostor gdje se osjeƒáa≈° voljeno i sigurno" },
  Lav:       { emoji:"ü¶Å", description:"samopouzdan, karizmatiƒçan i velikodu≈°an", traits:"izra≈æajnosti, strasti i kraljevske energije", connection:"ƒçini da se osjeƒáa≈° posebno i obo≈æavano" },
  Djevica:   { emoji:"üß†", description:"analitiƒçan, pa≈æljiv i pouzdan", traits:"preciznosti, brige i praktiƒçne podr≈°ke", connection:"donosi red u tvoje emocije i poma≈æe ti da raste≈°" },
  Vaga:      { emoji:"‚öñÔ∏è", description:"≈°armantan, diplomatski i estetski osvije≈°ten", traits:"ravnote≈æe, elegancije i emocionalne harmonije", connection:"uspostavlja sklad i njeguje tvoju nje≈ænu stranu" },
  ≈†korpion:  { emoji:"ü¶Ç", description:"intenzivan, misteriozan i duboko emotivan", traits:"strasti, dubine i magnetiƒçne privlaƒçnosti", connection:"izaziva te da se otvori≈° i osjeti≈° bez zadr≈°ke" },
  Strijelac: { emoji:"üèπ", description:"optimistiƒçan, avanturistiƒçki i iskren", traits:"slobode, iskrenosti i filozofske ≈°irine", connection:"≈°iri tvoje horizonte i potiƒçe tvoju znati≈æelju" },
  Jarac:     { emoji:"‚õ∞Ô∏è", description:"ambiciozan, stabilan i odgovoran", traits:"discipline, pouzdanosti i dugoroƒçnog razmi≈°ljanja", connection:"gradi s tobom temelje za trajnu vezu" },
  Vodenjak:  { emoji:"üîÆ", description:"inovativan, neovisan i vizionarski", traits:"mentalne slobode, originalnosti i humanosti", connection:"inspirira tvoju ma≈°tu i po≈°tuje tvoju individualnost" },
  Ribe:      { emoji:"üåä", description:"romantiƒçan, intuitivan i duhovan", traits:"empatije, snova i nje≈ænosti", connection:"povezuje se s tvojom du≈°om i razumije tvoje emocije" }
};

// üì≤ WhatsApp share
document.getElementById("whatsappShareBtn").onclick = () => {
  const topSign = Object.entries(scores).sort((a,b)=>b[1]-a[1])[0][0];
  const message = `Moj dominantni astrolo≈°ki znak je: ${topSign}! Saznaj svoj znak na na≈°em kvizu üîÆ`;
  const url = "https://www.lfbuyer.com/hr/zodijak/";
  window.open(`https://wa.me/?text=${encodeURIComponent(message + " " + url)}`, "_blank");
};

// üîÑ Restart logic
document.getElementById("restartBtn").onclick = initializeQuiz;

// üöÄ Start quiz & load data
document.addEventListener("DOMContentLoaded", () => {
  fetch("./questions.json")
    .then(res => res.json())
    .then(data => {
      allQuizSets = data;
      initializeQuiz();
    });

  fetch("./results.json")
    .then(res => res.json())
    .then(data => {
      results = data;
      fallbackPool = shuffleArray([...results.fallbacks]);
    });
});
</script>

<!-- 
 Copyright(c) 2025 RIOGB j.d.o.o.
  Sva prava pridr≈æana.

  Ova web stranica i njezin sadr≈æaj, ukljuƒçujuƒái ali ne ograniƒçavajuƒái se na tekst, slike i izvorni kod, 
  za≈°tiƒáeni su autorskim pravom i ne smiju se reproducirati, distribuirati niti prenositi 
  u bilo kojem obliku ili na bilo koji naƒçin bez prethodnog pisanog dopu≈°tenja vlasnika autorskih prava.
-->

<footer class="site-footer">
  <p>‚ú® Pokreƒáe te tvoja kozmiƒçka znati≈æelja ‚ú®</p>
  <p>&copy; <span id="current-year"></span> RIOGB j.d.o.o. Sva prava pridr≈æana.</p>
  <a href="https://www.lfbuyer.com/privacy-policy/" target="_blank" rel="noopener noreferrer">
    Pravila privatnosti
  </a>
</footer>

<script>
  // Automatsko a≈æuriranje godine u podno≈æju
  document.getElementById('current-year').textContent = new Date().getFullYear();
</script>
</body>
</html>
